<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>

  <!-- Bootstrap core CSS -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <!-- Custom styles for this template -->
  <link href="css/main.css" rel="stylesheet">
  <link href="css/all.css" rel="stylesheet"> <!--load all styles -->
  <!-- Bootstrap core JavaScript
     ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="js/jquery-3.5.1.min.js" crossorigin="anonymous"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.bundle.js"></script>
  <script src="js/loadingoverlay.min.js"></script>
  <link href="css/login.css" rel="stylesheet">
</head>
<body>
<div class="form">
  <div>
    <form th:action="@{/api/post}" th:object="${post}" method="post">
      <h4>Добавить пост</h4>
      <table class="w-100 mt-2">
        <tr>
          <td style="width: 600px;">
            <div class="form-group">
              <select class="form-control" name="postCategory" id="postCategorySelect"></select>
            </div></td>
        </tr>
        <tr>
          <td><input class="m-1" style="width: 600px;" type="text" name="title" placeholder="Заголовок"/></td>
        </tr>
        <tr>
          <td><textarea class="m-1" rows = "5" style="width: 600px;" name="content" placeholder="Контент"></textarea></td>
        </tr>
      </table>
      <br>
      <div class="w-100" style="text-align: right;">
        <button class="btn btn-primary bg-viola bg-viola_text pull-right" type="submit">Отправить</button>
      </div>
    </form>
  </div>
</div>

<script>
    fetch('/api/post-category')
        .then(response => response.json())
        .then(json => outputPostCategories(json))
</script>

<script>
    function outputPostCategories(postCategoryList) {
        const postCategorySelect = document.getElementById("postCategorySelect");
        postCategoryList.forEach(function (postCategory) {
            var newOption = document.createElement('option');
            newOption.value = encodeURIComponent(JSON.stringify(postCategory));
            newOption.text = postCategory.name;
            postCategorySelect.appendChild(newOption);
        });
    }
</script>

</body>
</html>